# AI-Mammoth Code Analysis System

[![Python 3.9+](https://img.shields.io/badge/python-3.9%2B-blue.svg)](https://www.python.org/)
[![FastAPI](https://img.shields.io/badge/FastAPI-0.95.0%2B-009688.svg)](https://fastapi.tiangolo.com/)
[![GigaChat](https://img.shields.io/badge/LLM-GigaChat-orange.svg)](https://developers.sber.ru/portal/products/gigachat)
[![Sber](https://img.shields.io/badge/Sber-Internal-green.svg)](https://www.sber.ru)
[![Node.js](https://img.shields.io/badge/Node.js-18.x%2B-brightgreen.svg)](https://nodejs.org/)
[![React](https://img.shields.io/badge/React-18.x-61DAFB.svg)](https://reactjs.org/)
[![LangChain](https://img.shields.io/badge/LangChain-0.1.0%2B-34D058.svg)](https://langchain.com/)
[![Spring Boot](https://img.shields.io/badge/Spring_Boot-2.7%2B-6DB33F.svg)](https://spring.io/projects/spring-boot)
[![Docker](https://img.shields.io/badge/Docker-Supported-2496ED.svg)](https://www.docker.com/)
[![ChromaDB](https://img.shields.io/badge/Vector_DB-ChromaDB-blueviolet.svg)](https://www.trychroma.com/)
![Code Size](https://img.shields.io/badge/Code%20Size-50K%2B%20lines-informational)
[![Documentation](https://img.shields.io/badge/Documentation-Comprehensive-blue.svg)](https://github.com/)
[![Activity](https://img.shields.io/badge/Activity-High-brightgreen.svg)](https://github.com/)
[![JIRA Integration](https://img.shields.io/badge/Integration-JIRA-0052CC.svg)](https://www.atlassian.com/software/jira)
[![Bitbucket Integration](https://img.shields.io/badge/Integration-Bitbucket-0052CC.svg)](https://bitbucket.org/)
[![Confluence Integration](https://img.shields.io/badge/Integration-Confluence-0052CC.svg)](https://www.atlassian.com/software/confluence)
[![Zephyr Integration](https://img.shields.io/badge/Integration-Zephyr-00B5D1.svg)](https://smartbear.com/test-management/zephyr/)

## Описание проекта

**AI-Mammoth** — революционная система автоматического анализа и верификации кода, созданная для существенного снижения количества ошибок при разработке программного обеспечения и ускорения процесса разработки. Система использует передовые технологии искусственного интеллекта для непрерывного анализа артефактов разработки: требований, кода, тест-кейсов и документации.

**Важно:** Проект состоит из двух
 репозиториев:
1. **Основной репозиторий** (текущий) — содержит ядро системы анализа и AI-агентов
2. **[AI-Mammoth-spring](https://github.com/SaltyFrappuccino/AI-Mammoth-spring)** — содержит Spring-приложение, которое автоматизирует работу с ассистентом и позволяет в автоматическом режиме собирать информацию из Confluence, Bitbucket, Jira и Zephyr (тест-кейсы)

**Публичный доступ:** Веб-интерфейс системы доступен по адресу [ai-mammoth-site.vercel.app/](https://ai-mammoth-site.vercel.app/)

## API-документация

API-система оснащена интерактивной документацией Swagger UI, которая позволяет:
- Изучить все доступные API-эндпоинты
- Проверить формат запросов и ответов
- Тестировать API напрямую из браузера

### Основные эндпоинты

- `/analyze` - POST запрос для выполнения анализа кода и требований
- `/api/health` - GET запрос для проверки состояния API

## Содержание

- [Ключевые преимущества](#ключевые-преимущества)
- [Архитектура системы](#архитектура-системы)
- [Технический стек](#технический-стек)
- [Компоненты ядра](#компоненты-ядра)
- [Система агентов](#система-агентов)
- [Интеграция с DevOps-инструментами](#интеграция-с-devops-инструментами)
- [Процесс анализа](#процесс-анализа)
- [Бизнес-выгоды](#бизнес-выгоды)
- [Примеры использования](#примеры-использования)
- [Установка и настройка](#установка-и-настройка)
- [Contributing](#contributing)
- [Лицензия](#лицензия)
- [Запуск GUI-приложения](#запуск-gui-приложения)

## Ключевые преимущества

- **Анализ дифференциала кода**: В отличие от большинства аналогов, анализирует только diff в pull request, а не весь кодовой база, что значительно повышает скорость работы
- **Автоматическая интеграция**: Собирает все артефакты из Jira, Confluence, Bitbucket и Zephyr автоматически
- **Многоуровневый анализ**: Оценивает соответствие между требованиями, кодом, тестами и документацией
- **Раннее обнаружение дефектов**: Выявляет потенциальные проблемы до этапа тестирования
- **Детальная отчётность**: Генерирует подробные отчеты с метриками и рекомендациями
- **Снижение Lead Time**: Сокращает время разработки благодаря автоматизированной верификации
- **Увеличение Deployment Frequency**: Повышает частоту релизов за счет раннего обнаружения ошибок

## Архитектура системы

AI-Mammoth построен на модульной архитектуре, основанной на принципах микросервисов и агентной модели. Система состоит из следующих ключевых уровней:

### 1. Уровень сбора данных
- **Интеграционные адаптеры** для Jira, Confluence, Bitbucket и Zephyr
- **Модуль парсинга diff** для анализа изменений в Pull Request
- **Система кэширования** для оптимизации повторных запросов

### 2. Уровень предобработки и хранения
- **Семантическая база данных** с векторным хранилищем
- **Система индексации** для быстрого поиска релевантных артефактов
- **Модуль нормализации данных** для унификации информации из разных источников

### 3. Уровень анализа (Ядро системы)
- **Система специализированных AI-агентов** для разных аспектов анализа
- **Оркестратор агентов** для управления очередностью и агрегации результатов
- **LLM-интеграция** для семантического анализа и генерации отчетов

### 4. Уровень представления
- **API-интерфейс** для интеграции с внешними системами
- **Система метрик и мониторинга** для отслеживания эффективности
- **Модуль генерации отчетов** с детальными результатами анализа

## Технический стек

AI-Mammoth использует современные технологии и библиотеки:

- **Python**: Основной язык для агентов анализа и ядра системы
- **FastAPI**: Высокопроизводительный API-фреймворк
- **LangChain**: Фреймворк для связи LLM-моделей с кодом
- **GigaChat API**: Основная LLM-модель для генерации и анализа
- **ChromaDB**: Векторная база данных для семантического поиска
- **Java/Spring Boot**: Для интеграционной части (AI-Mammoth-spring)
- **Docker/Kubernetes**: Для развертывания и масштабирования

## Компоненты ядра

### Aggregator (aggregator.py)
Центральный компонент системы, отвечающий за:
- Координацию работы всех агентов
- Сбор и агрегацию результатов анализа
- Формирование итогового отчета
- Сохранение результатов в JSON для дальнейшего использования

### SemanticDB (semantic_db.py)
Интеллектуальное хранилище, обеспечивающее:
- Векторизацию артефактов разработки
- Семантический поиск схожих документов
- Контекстуализацию для улучшения качества анализа
- Хранение исторических данных для сравнительного анализа

### Система конфигурации (config.py)
Гибкая система настройки, позволяющая:
- Конфигурировать параметры LLM-моделей
- Настраивать интеграции с внешними системами
- Управлять логированием и мониторингом
- Определять параметры проверок и анализа

## Система агентов

AI-Mammoth использует мультиагентную архитектуру, где каждый агент специализируется на конкретной области анализа:

### RequirementsAgent
- Анализирует и структурирует требования
- Классифицирует требования по типам и приоритетам
- Выявляет зависимости между требованиями
- Определяет ожидаемую реализацию для каждого требования

### CodeAgent
- Анализирует исходный код и его структуру
- Идентифицирует API эндпоинты и их функциональность
- Оценивает качество кода и архитектурные решения
- Выявляет потенциальные узкие места и технические долги

### TestCasesAgent
- Анализирует тестовое покрытие
- Сопоставляет тесты с требованиями
- Выявляет пробелы в тестировании
- Оценивает качество тестов и их полноту

### DocumentationAgent
- Анализирует техническую документацию
- Проверяет соответствие документации коду
- Выявляет устаревшие или неполные участки документации
- Предлагает улучшения для документации

### BugEstimatorAgent
- Прогнозирует потенциальные баги на основе анализа
- Классифицирует баги по серьезности и влиянию
- Предлагает конкретные шаги для исправления
- Оценивает риски и приоритезирует исправления

### ComplianceEvaluator
- Оценивает процент соответствия между кодом и требованиями
- Анализирует соответствие тестов требованиям
- Определяет соответствие кода тестам
- Предоставляет детальные объяснения метрик соответствия

### FinalReportAgent
- Агрегирует результаты всех агентов
- Формирует структурированный отчет с рекомендациями
- Выделяет ключевые проблемы и риски
- Сохраняет структурированные данные для дальнейшего использования

### SemanticAgent
- Обогащает анализ контекстной информацией
- Ищет релевантные артефакты в базе знаний
- Улучшает точность анализа с помощью дополнительного контекста
- Связывает различные артефакты на семантическом уровне

## Расширенные возможности

AI-Mammoth включает модули для расширенного анализа и представления результатов:

### VisualizationEngine
- Создает интерактивные визуализации метрик соответствия
- Генерирует графики и диаграммы для наглядного представления
- Экспортирует визуализации в различные форматы
- Встраивает визуальные элементы в отчеты

### RecommendationEngine
- Анализирует результаты оценки и генерирует рекомендации
- Приоритезирует рекомендации по важности и влиянию
- Предлагает конкретные шаги для улучшения
- Оценивает сложность и потенциальный эффект от внедрения

### SecurityAnalyzer
- Выявляет потенциальные уязвимости в коде
- Классифицирует уязвимости по типам и серьезности
- Предлагает меры по устранению угроз безопасности
- Связывает уязвимости с требованиями безопасности

## Интеграция с DevOps-инструментами

Проект [AI-Mammoth-spring](https://github.com/SaltyFrappuccino/AI-Mammoth-spring) обеспечивает бесшовную интеграцию с инструментами DevOps экосистемы:

### Интеграция с Jira
- Автоматическое получение детальной информации о Story и требованиях
- Обновление статусов и добавление комментариев с результатами анализа
- Создание задач для выявленных проблем
- Связывание проанализированных артефактов с задачами

### Интеграция с Bitbucket
- Анализ Pull Request и изменений кода
- Автоматические комментарии к проблемным участкам кода
- Интеграция с CI/CD пайплайнами
- Блокировка мерджа при обнаружении критических проблем

### Интеграция с Confluence
- Получение документации и требований
- Обновление страниц с результатами анализа
- Создание отчетов и дашбордов
- Ведение истории изменений и анализа

### Интеграция с Zephyr
- Получение тест-кейсов для анализа
- Оценка соответствия тестов требованиям
- Предложения по улучшению тестового покрытия
- Автоматическое обновление статусов тестов

## Процесс анализа

1. **Сбор артефактов**:
   - Spring-приложение собирает информацию из Jira, Confluence, Bitbucket и Zephyr
   - Данные нормализуются и структурируются для анализа
   - Формируется контекст для анализа, включая историю изменений

2. **Предобработка**:
   - Извлечение diff из Pull Request (анализируются только изменения, а не весь код)
   - Векторизация артефактов для семантического поиска
   - Определение релевантных требований и тестов для анализируемых изменений

3. **Параллельный анализ**:
   - RequirementsAgent анализирует требования
   - CodeAgent анализирует изменения кода
   - TestCasesAgent анализирует тестовое покрытие
   - DocumentationAgent анализирует документацию
   - SecurityAnalyzer оценивает безопасность изменений

4. **Агрегация и оценка**:
   - ComplianceEvaluator оценивает соответствие между артефактами
   - BugEstimatorAgent прогнозирует потенциальные баги
   - Формируются метрики и рекомендации

5. **Формирование отчета**:
   - FinalReportAgent создает структурированный отчет
   - VisualizationEngine добавляет визуализации
   - RecommendationEngine формирует приоритезированные рекомендации
   - Результаты сохраняются в структурированном формате

6. **Интеграция результатов**:
   - Отправка результатов в Jira, Confluence, Bitbucket
   - Обновление статусов и метрик
   - Создание задач для выявленных проблем

## Уникальные преимущества AI-Mammoth

1. **Анализ только изменений (diff)** — в отличие от аналогов, которые анализируют весь код, AI-Mammoth фокусируется только на изменениях в pull request, что делает его:
   - В 5-10 раз быстрее
   - Более точным в контексте конкретных изменений
   - Способным к интеграции даже в очень больших проектах

2. **Комплексный многоуровневый анализ** — единая система для анализа всех артефактов:
   - Требования → Код → Тесты → Документация
   - Выявление несоответствий между любыми артефактами
   - Оценка полноты и согласованности всех компонентов

3. **Семантический анализ** — использование передовых LLM для понимания смысла:
   - Глубокое понимание бизнес-логики требований
   - Оценка семантической правильности реализации
   - Интеллектуальные рекомендации, учитывающие контекст проекта

4. **Бесшовная интеграция с DevOps-циклом** — работа в существующих процессах:
   - Автоматический запуск при создании/обновлении pull request
   - Интеграция с CI/CD пайплайнами
   - Автоматическое обновление статусов и метрик в Jira

5. **Масштабируемость и гибкость** — адаптация к любым проектам и командам:
   - Конфигурируемые правила и проверки
   - Настраиваемые профили анализа для разных типов проектов
   - Поддержка микросервисной архитектуры

## Примеры использования

### Сценарий 1: Обнаружение несоответствий между требованиями и кодом
```
Требование REQ-5: "Система должна обеспечивать JWT-аутентификацию с временем жизни токена 30 минут"

AI-Mammoth анализирует код и обнаруживает:
- JWT-аутентификация реализована, но время жизни токена установлено на 60 минут
- Результат: Несоответствие требованию, с рекомендацией изменить конфигурацию
```

### Сценарий 2: Выявление пробелов в тестировании
```
Pull Request добавляет новый эндпоинт API для обработки платежей

AI-Mammoth анализирует и обнаруживает:
- Основная функциональность покрыта тестами
- Отсутствуют тесты для обработки ошибок при недоступности платежного шлюза
- Результат: Рекомендация добавить тесты для сценариев ошибок
```

### Сценарий 3: Обнаружение потенциальных багов
```
Pull Request изменяет логику обработки пользовательских настроек

AI-Mammoth анализирует и обнаруживает:
- Отсутствие проверки на null при получении настроек из БД
- Потенциальный NullPointerException при определенных условиях
- Результат: Детальное описание бага с предложением конкретного исправления
```

## Установка и настройка

### Требования
- Python 3.9+
- Java 17+ (для Spring-части)
- Node.js 18.x+ (для веб-интерфейса)
- Docker и Docker Compose
- Доступ к API LLM-модели (GigaChat)

### Установка

1. Клонируйте репозиторий:
```bash
git clone https://github.com/SaltyFrappuccino/AI-Mammoth-agent.git
```

2. Настройте переменные окружения:
```bash
cd AI-Mammoth-agent
cp .env.example .env
# Отредактируйте .env файл, добавив ключи API и конфигурацию
```

3. Установите зависимости:
```bash
pip install -r requirements.txt
```

4. Запустите API:
```bash
python main.py
```

### Запуск API через Docker

1. Сборка Docker-образа:
```bash
docker build -t ai-mammoth-api .
```

2. Запуск контейнера:
```bash
docker run -d -p 8080:8080 --name ai-mammoth-api-container ai-mammoth-api
```

### Конфигурация

В файле `config.py` вы можете настроить:
- Параметры LLM-модели и API-ключи
- Пороговые значения для метрик соответствия
- Настройки логирования и мониторинга
- Параметры анализа безопасности

## Запуск веб-интерфейса

AI-Mammoth предоставляет графический веб-интерфейс для удобной работы с системой анализа кода.

### Вариант 1: Запуск через Node.js

1. Перейдите в директорию веб-интерфейса:
   ```bash
   cd web
   ```

2. Установите зависимости:
   ```bash
   npm install
   ```

3. Запустите веб-приложение в режиме разработки:
   ```bash
   npm start
   ```
   Приложение будет доступно по адресу http://localhost:3000

### Вариант 2: Запуск исполняемого файла (.exe) - только для Windows

#### Использование готового .exe файла
1. Скачайте последнюю версию AI-Mammoth-GUI.exe из раздела [Releases](https://github.com/SaltyFrappuccino/AI-Mammoth-agent/releases)
2. Запустите AI-Mammoth-GUI.exe двойным кликом

#### Самостоятельная сборка .exe файла
Если вы хотите собрать .exe файл самостоятельно:

1. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```

2. Запустите скрипт сборки:
   ```bash
   python build_exe.py
   ```

3. После завершения сборки исполняемый файл будет доступен в директории `dist/AI-Mammoth-GUI.exe`

### Вариант 3: Использование публичного доступа
Веб-интерфейс системы доступен по адресу [https://ai-mammoth-site.vercel.app/](https://ai-mammoth-site.vercel.app/)

#### Примечания по использованию .exe файла
- Исполняемый файл является полностью автономным и не требует установленного Python
- При первом запуске Windows может показать предупреждение безопасности - нажмите "Подробнее" и "Выполнить в любом случае"
- Все логи приложения сохраняются в файл `gui.log` в той же директории, где находится .exe файл
- Для корректной работы Markdown-разметки в отчетах убедитесь, что в системе установлена библиотека tkhtmlview

## Заключение

AI-Mammoth — это не просто инструмент анализа кода, а полноценная платформа для обеспечения качества на всех этапах разработки. Благодаря фокусу на анализе только изменений (diff), интеграции с ключевыми DevOps-инструментами и использованию передовых технологий искусственного интеллекта, система обеспечивает беспрецедентный уровень автоматизации и качества.

Ключевые особенности:
- Мультиагентная архитектура для комплексного анализа
- Интеграция с полным циклом DevOps
- Фокус на изменениях (diff), а не на всем коде
- Семантический анализ с использованием LLM
- Измеримое влияние на ключевые метрики разработки

Внедрение AI-Mammoth позволяет создать более надежный, предсказуемый и эффективный процесс разработки, существенно сократить время вывода продукта на рынок и повысить общее качество программного обеспечения.

---

*AI-Mammoth - ускоряем разработку, снижаем ошибки, повышаем качество.*
